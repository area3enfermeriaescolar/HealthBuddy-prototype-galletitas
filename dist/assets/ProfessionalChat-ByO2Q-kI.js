import{r as d,j as t}from"./index-t3TyDbTL.js";/* empty css                              */const n={primary:"#00B7D8",textDark:"#2C3E50",textMedium:"#4A6572",lightBg:"#F7FAFC",lightGrey:"#ECEFF1",danger:"#E74C3C"},v=()=>t.jsx("div",{style:{position:"fixed",top:10,right:10,background:"#00B7D8",color:"#fff",padding:"4px 12px",borderRadius:20,fontSize:"0.75rem",fontWeight:600,letterSpacing:.5,zIndex:1e3},children:"DEMO"}),R=[{id:"est1",nre:"30012345",center:"IES Mediterráneo",unread:!0,messages:[{from:"student",text:"Buenos días, tengo una duda sobre métodos anticonceptivos.",ts:"10:00"},{from:"pro",text:"Hola, cuéntame en qué puedo ayudarte.",ts:"10:02"},{from:"student",text:"¿Es seguro usar solo preservativo o debería combinar con otro método?",ts:"10:03"}]},{id:"est2",nre:"30023456",center:"IES Mar Menor",unread:!1,messages:[{from:"student",text:"No me encuentro bien hoy, tengo mucha ansiedad por los exámenes.",ts:"09:30"},{from:"pro",text:"Lamento escuchar eso. ¿Has probado alguna técnica de relajación?",ts:"09:35"},{from:"student",text:"He intentado respirar profundo pero no me funciona mucho.",ts:"09:40"},{from:"pro",text:"Entiendo. ¿Te gustaría que hablemos sobre esto en tu próxima cita? Podría enseñarte algunas técnicas más efectivas.",ts:"09:42"}]},{id:"est3",nre:"30034567",center:"IES Mar Menor",unread:!0,messages:[{from:"student",text:"Hola, ¿cuándo es tu próxima visita a nuestro instituto?",ts:"11:15"}]},{id:"est4",nre:"30045678",center:"IES San Juan Bosco",unread:!1,messages:[{from:"student",text:"Gracias por la información de ayer, me ha sido muy útil.",ts:"08:45"},{from:"pro",text:"Me alegro mucho. Recuerda que estoy aquí para lo que necesites.",ts:"09:00"}]},{id:"est5",nre:"30056789",center:"IES San Juan Bosco",unread:!0,messages:[{from:"student",text:"Tengo un problema con un compañero de clase, ¿podríamos hablar?",ts:"10:30"}]}],D=({onNavigate:f})=>{const[x,g]=d.useState(""),[r,p]=d.useState(null),[l,y]=d.useState(""),[c,m]=d.useState(R),b=d.useRef(null),j=d.useRef(null);d.useEffect(()=>{var e;(e=b.current)==null||e.scrollIntoView({behavior:"smooth"})},[r==null?void 0:r.messages]);const w=c.reduce((e,s)=>(e[s.center]||(e[s.center]=[]),e[s.center].push(s),e),{}),k=e=>e.nre.toLowerCase().includes(x.toLowerCase())||e.center.toLowerCase().includes(x.toLowerCase()),S=()=>{if(!l.trim())return;const e=[...c],s=e.findIndex(o=>o.id===r.id);if(s!==-1){const o={...e[s]};o.messages=[...o.messages,{from:"pro",text:l,ts:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}],o.unread=!1,e[s]=o,m(e),p(o)}y(""),setTimeout(()=>{var o;(o=j.current)==null||o.focus()},0)},z=e=>{if(e.unread){const s=c.map(o=>o.id===e.id?{...o,unread:!1}:o);m(s),p({...e,unread:!1})}else p(e)};d.useEffect(()=>{if(r&&r.messages.length>0&&r.messages[r.messages.length-1].from==="pro"&&r.messages.length>1&&Math.random()>.7){const o=2e3+Math.random()*3e3,i=setTimeout(()=>{const C=["Gracias por la información.","Entiendo, lo tendré en cuenta.","¿Podríamos hablar de esto en la próxima consulta?","Vale, intentaré seguir tu consejo.","¿Hay algo más que deba saber sobre esto?"],M=C[Math.floor(Math.random()*C.length)],u=[...c],h=u.findIndex(a=>a.id===r.id);if(h!==-1){const a={...u[h]};a.messages=[...a.messages,{from:"student",text:M,ts:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}],a.unread=!0,u[h]=a,m(u),r&&r.id===a.id&&p(a)}},o);return()=>clearTimeout(i)}},[r,c]);const I=e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),S())};return r?t.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:n.lightBg,display:"flex",flexDirection:"column"},children:[t.jsx(v,{}),t.jsx("div",{style:{background:"white",padding:"1rem",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx("button",{onClick:()=>p(null),style:{background:"none",border:"none",color:n.primary,fontSize:24,cursor:"pointer",padding:0},children:"←"}),t.jsxs("div",{children:[t.jsxs("h2",{style:{margin:0,fontSize:16,color:n.textDark,display:"flex",alignItems:"center",gap:8},children:[t.jsx("span",{style:{fontSize:18,color:n.primary},children:"👤"})," NRE: ",r.nre]}),t.jsxs("p",{style:{fontSize:13,color:n.textMedium,margin:"4px 0 0 0",display:"flex",alignItems:"center",gap:6},children:[t.jsx("span",{style:{fontSize:14,color:n.primary},children:"🏫"})," ",r.center]})]})]}),t.jsxs("button",{style:{background:"none",border:`1px solid ${n.primary}`,color:n.primary,borderRadius:8,padding:"6px 10px",fontSize:13,cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[t.jsx("span",{children:"📋"})," Ver historial"]})]})}),t.jsxs("div",{style:{background:n.danger,color:"white",padding:"10px 12px",display:"flex",alignItems:"center",gap:8,fontSize:13},children:[t.jsx("span",{style:{fontSize:16},children:"🔒"})," Esta consulta es confidencial y anónima."]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"1rem",paddingBottom:"80px"},children:[r.messages.map((e,s)=>t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:e.from==="pro"?"flex-end":"flex-start",marginBottom:16},children:[t.jsx("div",{style:{background:e.from==="pro"?n.primary:"white",color:e.from==="pro"?"white":n.textDark,padding:"10px 16px",borderRadius:16,borderBottomLeftRadius:e.from==="pro"?16:4,borderBottomRightRadius:e.from==="pro"?4:16,maxWidth:"80%",wordBreak:"break-word",boxShadow:e.from==="student"?"0 2px 4px rgba(0,0,0,0.05)":"none",fontSize:14},children:e.text}),t.jsx("span",{style:{fontSize:11,color:n.textMedium,marginTop:4,alignSelf:e.from==="pro"?"flex-end":"flex-start"},children:e.ts})]},s)),t.jsx("div",{ref:b})]}),t.jsx("div",{style:{position:"absolute",bottom:"60px",left:0,right:0,background:"white",borderTop:`1px solid ${n.lightGrey}`,padding:"8px 12px",boxShadow:"0 -2px 10px rgba(0,0,0,0.05)"},children:t.jsxs("div",{style:{display:"flex",gap:8,maxWidth:800,margin:"0 auto"},children:[t.jsx("textarea",{ref:j,value:l,onChange:e=>y(e.target.value),onKeyDown:I,placeholder:"Escribe un mensaje...",style:{flex:1,padding:"8px 12px",borderRadius:20,border:`1px solid ${n.lightGrey}`,resize:"none",fontSize:14,minHeight:40,maxHeight:120,backgroundColor:n.lightBg,fontFamily:"inherit",outline:"none"},rows:1}),t.jsx("button",{onClick:S,disabled:!l.trim(),style:{background:l.trim()?n.primary:"#ccc",color:"white",border:"none",borderRadius:"50%",width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:l.trim()?"pointer":"not-allowed",fontSize:20,flexShrink:0},children:"↑"})]})}),t.jsx("div",{style:{position:"fixed",left:0,right:0,bottom:0,background:"#fff",boxShadow:"0 -2px 8px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",padding:"0.6rem 0",zIndex:40,height:"60px"},children:[{id:"dashboard",label:"Inicio",icon:"🏠"},{id:"chat",label:"Chat",icon:"💬"},{id:"appointments",label:"Citas",icon:"📅"},{id:"resources",label:"Recursos",icon:"📚"}].map(e=>t.jsxs("div",{onClick:()=>f(e.id),style:{textAlign:"center",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx("div",{style:{fontSize:"1.6rem",color:e.id==="chat"?n.primary:n.textMedium},children:e.icon}),t.jsx("span",{style:{fontSize:12,color:e.id==="chat"?n.primary:n.textMedium,fontWeight:e.id==="chat"?600:400},children:e.label})]},e.id))})]}):t.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:n.lightBg,display:"flex",flexDirection:"column"},children:[t.jsx(v,{}),t.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"1rem",position:"relative",backgroundColor:"white",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[t.jsxs("button",{onClick:()=>f("dashboard"),style:{background:"none",border:"none",color:n.primary,fontSize:16,display:"flex",alignItems:"center",gap:4,cursor:"pointer",padding:0,position:"absolute",left:"1rem"},children:[t.jsx("span",{style:{fontSize:20},children:"←"})," Atrás"]}),t.jsx("h1",{style:{flex:1,textAlign:"center",fontWeight:"bold",fontSize:18,margin:0},children:"Chat con estudiantes"})]}),t.jsx("div",{style:{padding:"1rem"},children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{value:x,onChange:e=>g(e.target.value),placeholder:"Buscar por NRE o centro",style:{width:"100%",padding:"8px 16px 8px 36px",borderRadius:8,border:`1px solid ${n.lightGrey}`,fontSize:14}}),t.jsx("span",{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:n.textMedium,fontSize:18},children:"🔍"}),x&&t.jsx("button",{onClick:()=>g(""),style:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:n.textMedium,fontSize:16,cursor:"pointer"},children:"✕"})]})}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",marginBottom:"1rem"},children:[t.jsx("span",{style:{fontSize:14,color:n.textMedium},children:"Conversaciones activas"}),t.jsxs("span",{style:{background:n.primary,color:"white",borderRadius:20,padding:"4px 12px",fontSize:13,fontWeight:500},children:[c.filter(e=>e.unread).length," sin leer"]})]}),t.jsx("div",{style:{flex:1,overflowY:"auto",padding:"0 1rem",paddingBottom:"80px"},children:Object.entries(w).map(([e,s])=>{const o=s.filter(k);return o.length===0?null:t.jsxs("div",{style:{marginBottom:24},children:[t.jsxs("h2",{style:{color:n.textDark,marginBottom:12,fontSize:16,display:"flex",alignItems:"center",gap:8},children:[t.jsx("span",{style:{fontSize:18,color:n.primary},children:"🏫"})," ",e]}),o.map(i=>t.jsx("div",{onClick:()=>z(i),style:{background:"white",padding:12,borderRadius:12,marginBottom:12,cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",borderLeft:i.unread?`4px solid ${n.primary}`:"none",paddingLeft:i.unread?8:12},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsxs("p",{style:{margin:0,fontWeight:i.unread?600:500,color:n.textDark,display:"flex",alignItems:"center",gap:6,fontSize:14},children:[t.jsx("span",{style:{fontSize:16,color:n.primary},children:"👤"}),"NRE: ",i.nre]}),t.jsxs("div",{style:{fontSize:12,color:i.unread?n.textDark:n.textMedium,marginTop:4,display:"flex",alignItems:"center",gap:4},children:[t.jsx("span",{style:{maxWidth:"180px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:i.messages.slice(-1)[0].text}),t.jsxs("span",{style:{fontSize:11,color:n.textMedium},children:["• ",i.messages.slice(-1)[0].ts]})]})]}),i.unread&&t.jsx("span",{style:{background:n.primary,color:"white",width:24,height:24,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:"bold"},children:"!"})]})},i.id))]},e)})}),t.jsx("div",{style:{position:"fixed",left:0,right:0,bottom:0,background:"#fff",boxShadow:"0 -2px 8px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",padding:"0.6rem 0",zIndex:40,height:"60px"},children:[{id:"dashboard",label:"Inicio",icon:"🏠"},{id:"chat",label:"Chat",icon:"💬"},{id:"appointments",label:"Citas",icon:"📅"},{id:"resources",label:"Recursos",icon:"📚"}].map(e=>t.jsxs("div",{onClick:()=>f(e.id),style:{textAlign:"center",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx("div",{style:{fontSize:"1.6rem",color:e.id==="chat"?n.primary:n.textMedium},children:e.icon}),t.jsx("span",{style:{fontSize:12,color:e.id==="chat"?n.primary:n.textMedium,fontWeight:e.id==="chat"?600:400},children:e.label})]},e.id))})]})};export{D as default};
