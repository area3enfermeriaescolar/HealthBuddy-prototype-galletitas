import{c as G,r as a,j as e}from"./index-CAa7WQB5.js";import{g as J,u as X,c as K}from"./appointmentService-C9QCYLor.js";const r={primary:"#00B7D8",lightBg:"#F5FBFD",textDark:"#002D3A",textMedium:"#4A6572",error:"#d32f2f",success:"#388e3c",warning:"#f57c00"};function Q({active:h,onNavigate:l}){const m=[{id:"home",label:"Inicio",icon:"üè†"},{id:"chat",label:"Chat",icon:"üí¨"},{id:"appointments",label:"Citas",icon:"üìÖ"},{id:"resources",label:"Recursos",icon:"üìö"}];return e.jsx("div",{style:{position:"fixed",left:0,right:0,bottom:0,background:"#fff",boxShadow:"0 -2px 8px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",padding:"0.6rem 0",zIndex:100},children:m.map(d=>e.jsxs("div",{onClick:()=>l(d.id),style:{textAlign:"center",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:"1.6rem",color:d.id===h?r.primary:r.textMedium},children:d.icon}),e.jsx("span",{style:{fontSize:12,color:d.id===h?r.primary:r.textMedium,fontWeight:d.id===h?600:400},children:d.label})]},d.id))})}function _({onNavigate:h}){var M;const{currentUser:l}=G(),[m,d]=a.useState("upcoming"),[W,v]=a.useState(0),[i,w]=a.useState(null),[u,k]=a.useState(""),[I,j]=a.useState(!1),[E,C]=a.useState(!1),[D,z]=a.useState(""),[O,L]=a.useState(typeof window<"u"?window.innerWidth:768),[B,N]=a.useState([]),[T,f]=a.useState(!0),[R,x]=a.useState(null),[g,A]=a.useState(!1),s=O<768;a.useLayoutEffect(()=>{const t=()=>{L(window.innerWidth)};if(typeof window<"u")return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),a.useEffect(()=>{if(!l){f(!1);return}f(!0),x(null);try{const t=J(l.uid,n=>{const c=n.map(o=>({id:o.id,date:new Date(o.date.seconds*1e3).toLocaleDateString("es-ES",{day:"2-digit",month:"short"}),time:o.time,with:o.professionalName||"Luc√≠a Mart√≠nez",role:o.professionalRole||"Enfermera Escolar",reason:o.reason,status:o.status,location:o.location||"Sala 12, junto a Orientaci√≥n",notes:o.notes,originalDate:o.date}));N(c),f(!1)});return()=>t()}catch(t){console.error("Error al cargar citas:",t),x("Error al cargar las citas"),f(!1)}},[l]);const y=(()=>{const t=new Date,n=new Date(t);return n.setDate(t.getDate()+W*7),[n.getDay()<=2?2-n.getDay():9-n.getDay(),n.getDay()<=4?4-n.getDay():11-n.getDay()].map(o=>{const p=new Date(n);return p.setDate(n.getDate()+o),p})})(),b=t=>{const n={weekday:"short",day:"2-digit",month:"short"};return t.toLocaleDateString("es-ES",n)},$=["10:00 - 10:15","10:15 - 10:30","10:30 - 10:45","10:45 - 11:00"],F=(t,n)=>{w({date:t,time:n})},H=()=>{!i||!u||!l||j(!0)},U=async()=>{if(!(!l||!i)){A(!0),x(null);try{const t={studentId:l.uid,studentName:l.displayName||l.email,professionalId:"lucia-martinez-id",professionalName:"Luc√≠a Mart√≠nez",professionalRole:"Enfermera Escolar",date:i.date,time:i.time,reason:u,notes:D,status:"pending",location:"Sala 12, junto a Orientaci√≥n",createdAt:new Date};await K(t),j(!1),C(!0),setTimeout(()=>{C(!1),w(null),k(""),z(""),d("upcoming")},3e3)}catch(t){console.error("Error al crear la cita:",t),x("Error al solicitar la cita. Por favor, int√©ntalo de nuevo.")}finally{A(!1)}}},S=[{value:"general",label:"Consulta general"},{value:"followup",label:"Seguimiento"},{value:"sexual-health",label:"Salud sexual y reproductiva"},{value:"mental-health",label:"Salud mental y emocional"},{value:"nutrition",label:"Nutrici√≥n y alimentaci√≥n"},{value:"other",label:"Otro (especificar en notas)"}],q=[{id:"upcoming",label:"Mis citas"},{id:"book",label:"Solicitar cita"}],P=async t=>{if(window.confirm("¬øEst√°s seguro/a de que deseas cancelar esta cita?"))try{await X(t,"cancelled")}catch(n){console.error("Error al cancelar la cita:",n),x("Error al cancelar la cita")}};return l?e.jsxs("div",{style:{padding:s?"0.75rem":"1rem",paddingBottom:80,backgroundColor:r.lightBg,minHeight:"100vh",maxWidth:"100%",overflowX:"hidden"},children:[e.jsxs("div",{style:{marginBottom:s?"1rem":"1.5rem",textAlign:"center"},children:[e.jsx("h1",{style:{fontSize:s?"1.3rem":"1.5rem",color:r.textDark,margin:0,fontWeight:600},children:"Citas Consulta Joven"}),e.jsx("p",{style:{margin:"0.5rem 0 0 0",color:r.textMedium,fontSize:s?"0.85rem":"0.9rem"},children:"Gestiona tus consultas con el personal sanitario"})]}),R&&e.jsxs("div",{style:{background:"#ffebee",borderLeft:`4px solid ${r.error}`,color:r.error,padding:"1rem",borderRadius:8,marginBottom:"1rem",display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"‚ö†Ô∏è"}),e.jsx("p",{style:{margin:0},children:R})]}),e.jsx("div",{style:{display:"flex",background:"white",borderRadius:12,overflow:"hidden",marginBottom:"1rem",boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},children:q.map(t=>e.jsx("button",{onClick:()=>d(t.id),style:{flex:1,padding:"0.8rem",background:m===t.id?r.primary:"transparent",color:m===t.id?"white":r.textMedium,border:"none",fontSize:"0.95rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},children:t.label},t.id))}),E&&e.jsxs("div",{style:{background:"#e8f5e9",borderLeft:`4px solid ${r.success}`,color:r.success,padding:"1rem",borderRadius:8,marginBottom:"1rem",display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"‚úì"}),e.jsx("p",{style:{margin:0},children:"¬°Cita solicitada con √©xito! Recibir√°s una notificaci√≥n cuando sea confirmada."})]}),m==="upcoming"&&e.jsx("div",{style:{marginBottom:"1.5rem"},children:T?e.jsxs("div",{style:{background:"white",borderRadius:12,padding:"2rem 1.5rem",textAlign:"center",boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"‚è≥"}),e.jsx("p",{style:{color:r.textMedium},children:"Cargando tus citas..."})]}):B.length>0?e.jsx("div",{children:B.map(t=>{var n;return e.jsx("div",{style:{background:"white",borderRadius:12,padding:"1rem",marginBottom:"1rem",boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start",flexDirection:s?"column":"row"},children:[e.jsxs("div",{style:{background:r.lightBg,borderRadius:12,padding:"0.8rem 0.4rem",textAlign:"center",minWidth:60,width:s?"100%":"auto",display:s?"flex":"block",justifyContent:"center",alignItems:"center",gap:"0.5rem",marginBottom:s?"0.5rem":0},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:600,color:r.primary},children:t.date.split(" ")[0]}),e.jsx("div",{style:{fontSize:"0.9rem",color:r.textMedium},children:t.date.split(" ")[1]})]}),e.jsxs("div",{style:{flex:1,width:s?"100%":"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem",flexDirection:s?"column":"row"},children:[e.jsxs("div",{style:{marginBottom:s?"0.5rem":0},children:[e.jsx("h3",{style:{margin:0,color:r.textDark,fontSize:"1rem",fontWeight:600},children:((n=S.find(c=>c.value===t.reason))==null?void 0:n.label)||t.reason}),e.jsx("p",{style:{margin:"0.2rem 0 0 0",color:r.primary,fontWeight:500,fontSize:"0.9rem"},children:t.time})]}),e.jsx("div",{style:{background:t.status==="confirmed"?"#e8f5e9":t.status==="cancelled"?"#ffebee":"#fffde7",color:t.status==="confirmed"?r.success:t.status==="cancelled"?r.error:r.warning,padding:"0.3rem 0.6rem",borderRadius:8,fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase"},children:t.status==="pending"?"Pendiente":t.status==="confirmed"?"Confirmada":"Cancelada"})]}),e.jsxs("p",{style:{margin:"0 0 0.5rem 0",color:r.textMedium,fontSize:"0.9rem"},children:["Con ",t.with," (",t.role,")"]}),e.jsxs("p",{style:{margin:"0 0 0.5rem 0",color:r.textMedium,fontSize:"0.9rem"},children:["Ubicaci√≥n: ",t.location]}),t.notes&&e.jsxs("p",{style:{margin:"0 0 0.5rem 0",color:r.textMedium,fontSize:"0.9rem",fontStyle:"italic"},children:["Notas: ",t.notes]}),t.status==="pending"&&e.jsx("button",{onClick:()=>P(t.id),style:{background:"transparent",border:`1px solid ${r.error}`,color:r.error,padding:"0.5rem 1rem",borderRadius:8,cursor:"pointer",fontSize:"0.85rem",fontWeight:600,marginTop:"0.5rem"},children:"Cancelar Cita"})]})]})},t.id)})}):e.jsxs("div",{style:{background:"white",borderRadius:12,padding:"2rem 1.5rem",textAlign:"center",boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"üóìÔ∏è"}),e.jsx("p",{style:{color:r.textMedium},children:"No tienes citas programadas."})]})}),m==="book"&&e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{background:"white",borderRadius:12,padding:"1.5rem",boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},children:[e.jsx("h3",{style:{color:r.textDark,fontSize:"1.1rem",marginBottom:"1rem"},children:"Selecciona una fecha y hora"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("button",{onClick:()=>v(t=>t-1),style:{background:r.primary,color:"white",border:"none",borderRadius:"50%",width:30,height:30,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"1.2rem"},children:"‚Üê"}),e.jsxs("span",{style:{color:r.textDark,fontWeight:600,fontSize:"0.95rem"},children:[b(y[0])," - ",b(y[y.length-1])]}),e.jsx("button",{onClick:()=>v(t=>t+1),style:{background:r.primary,color:"white",border:"none",borderRadius:"50%",width:30,height:30,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"1.2rem"},children:"‚Üí"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"repeat(2, 1fr)",gap:"0.75rem",marginBottom:"1.5rem"},children:y.map(t=>{var n;return e.jsxs("div",{style:{background:r.lightBg,borderRadius:8,padding:"0.75rem",textAlign:"center",border:((n=i==null?void 0:i.date)==null?void 0:n.toISOString())===t.toISOString()?`2px solid ${r.primary}`:"1px solid #eee",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:r.textDark,fontSize:"0.9rem"},children:b(t)}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.5rem"},children:$.map(c=>{var o,p;return e.jsx("button",{onClick:()=>F(t,c),style:{background:((o=i==null?void 0:i.date)==null?void 0:o.toISOString())===t.toISOString()&&(i==null?void 0:i.time)===c?r.primary:"white",color:((p=i==null?void 0:i.date)==null?void 0:p.toISOString())===t.toISOString()&&(i==null?void 0:i.time)===c?"white":r.textMedium,border:`1px solid ${r.primary}`,borderRadius:6,padding:"0.4rem 0.6rem",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s"},children:c},c)})})]},t.toISOString())})}),i&&e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:{color:r.textDark,fontSize:"1.1rem",marginBottom:"1rem"},children:"Detalles de la cita"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:r.textDark,fontWeight:500},children:"Motivo de la cita:"}),e.jsxs("select",{value:u,onChange:t=>k(t.target.value),style:{width:"100%",padding:"0.6rem",borderRadius:8,border:"1px solid #ccc",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecciona un motivo"}),S.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:r.textDark,fontWeight:500},children:"Notas adicionales (opcional):"}),e.jsx("textarea",{value:D,onChange:t=>z(t.target.value),placeholder:"¬øHay algo m√°s que debamos saber?",rows:"3",style:{width:"100%",padding:"0.6rem",borderRadius:8,border:"1px solid #ccc",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsx("button",{onClick:H,disabled:!u||g,style:{background:r.primary,color:"white",border:"none",borderRadius:8,padding:"0.8rem 1.5rem",fontSize:"1rem",fontWeight:600,cursor:"pointer",width:"100%",opacity:g?.7:1,transition:"opacity 0.2s"},children:g?"Solicitando...":"Solicitar Cita"})]})]})}),I&&i&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:12,padding:"2rem",textAlign:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",maxWidth:s?"90%":"400px"},children:[e.jsx("h3",{style:{color:r.textDark,marginBottom:"1rem"},children:"Confirmar Cita"}),e.jsxs("p",{style:{color:r.textMedium,marginBottom:"0.5rem"},children:["Fecha: ",e.jsx("strong",{children:b(i.date)})]}),e.jsxs("p",{style:{color:r.textMedium,marginBottom:"0.5rem"},children:["Hora: ",e.jsx("strong",{children:i.time})]}),e.jsxs("p",{style:{color:r.textMedium,marginBottom:"1.5rem"},children:["Motivo: ",e.jsx("strong",{children:((M=S.find(t=>t.value===u))==null?void 0:M.label)||u})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"1rem"},children:[e.jsx("button",{onClick:()=>j(!1),style:{background:"transparent",border:`1px solid ${r.textMedium}`,color:r.textMedium,padding:"0.6rem 1.2rem",borderRadius:8,cursor:"pointer",fontSize:"0.9rem",fontWeight:600,flex:1},children:"Cancelar"}),e.jsx("button",{onClick:U,disabled:g,style:{background:r.primary,color:"white",border:"none",borderRadius:8,padding:"0.6rem 1.2rem",fontSize:"0.9rem",fontWeight:600,cursor:"pointer",flex:1,opacity:g?.7:1},children:g?"Confirmando...":"Confirmar"})]})]})}),e.jsx(Q,{active:"appointments",onNavigate:h})]}):e.jsxs("div",{style:{padding:"2rem",textAlign:"center",backgroundColor:r.lightBg,minHeight:"100vh"},children:[e.jsx("h2",{style:{color:r.error},children:"Acceso no autorizado"}),e.jsx("p",{style:{color:r.textMedium},children:"Debes iniciar sesi√≥n para acceder a tus citas."})]})}export{_ as default};
